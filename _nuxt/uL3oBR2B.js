import{_ as S}from"./BJK6CfT8.js";import{_ as q}from"./Kjik69_P.js";import{_ as I}from"./DMShyNhy.js";import R from"./CDtkRi69.js";import{_ as F}from"./Dp1RMNuK.js";import{d as C,r as p,b as s,c as a,F as k,M as A,D as f,e as g,t as T,n as D,L as z,I as x,v as E,J as L,g as c,w,f as V,q as y,N as H,O as J}from"./DGremdG2.js";import"./B9lHIL7h.js";import"./DlAUqK2U.js";const j=["Ambient","Ambient Dub","Ambient Pop","Ambient Techno","Art Rock","Berlin School","Chamber Folk","Chamber Pop","Chillout","Choral","Dark Ambient","Dark Jazz","Downtempo","Dream Pop","Drone","Dub","Electronic","Experimental Rock","Glitch","IDM","Illbient","Indie Folk","Microhouse","Minimal Techno","Minimalism","Modern Classical","New Age","Novo Dub","Post-Industrial","Post-Minimalism","Post-Rock","Progressive Electronic","Singer-Songwriter","Space Ambient","Tape Music","Trip Hop","Video Game Music"],O={class:"flex flex-wrap gap-2"},U=["onClick"],K=C({__name:"MusicGenres",emits:["select-genre"],setup(M,{emit:r}){const u=r,i=p(-1);function o(n){return console.log(n,i.value),n===i.value}function l(n,d,e){if(o(e))return i.value=-1,u("select-genre","*");i.value=e,u("select-genre",d)}return(n,d)=>(s(),a("div",O,[(s(!0),a(k,null,A(f(j),(e,m)=>(s(),a("div",{onClick:h=>l(h,e,m),class:"cursor-pointer",key:`genre-${e}`},[g("span",{class:D([{"bg-text dark:text-gray-90":o(m)},"genre bg-gray-90 text-gray-20 text-xs p-2 rounded-md line-clamp-1 bottom-0"])},T(e),3)],8,U))),128))]))}}),Q={class:"flex justify-between"},W={class:"mb-8"},X={key:0},re=C({__name:"index",async setup(M){let r,u;const i=p({where:[{type:"album"}],limit:20,sort:[{date:-1}]}),o=p("Ambient"),l=p([]);l.value=([r,u]=z(()=>y("albums").find()),r=await r,u(),r||[]),x(o,async t=>{await e(t)});const n=E();x(()=>n.fullPath,async()=>{console.log("route changed",n),await e(n.query.genre)},{immediate:!1});function d(t){if(t===o.value)return o.value="*";o.value=t}async function e(t){if(t==="*")return l.value=await y("albums").find()||[];if(l.value=await y("albums").where({genres:{$contains:t}}).find()||[],!window)return;const _=new URL(window==null?void 0:window.location.href);_.searchParams.set("genre",t),window==null||window.history.pushState({},"",_)}const m=p(4),h=L(()=>m.value?`grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-${m.value}`:"grid-cols-2 lg:grid-cols-3");return(t,_)=>{const P=S,G=q,N=I,$=R,B=F;return s(),a("main",null,[c(B,null,{default:w(()=>[g("div",Q,[c(P,{type:"h1",element:"h1",class:"mb-8",text:"Albums"})]),g("div",W,[c(K,{onSelectGenre:_[0]||(_[0]=b=>d(b))})]),c($,{query:f(i)},{default:w(({navigation:b})=>[b?(s(),a("div",X,[g("ul",{class:D(["grid gap-8",f(h)])},[(s(!0),a(k,null,A(f(l),v=>(s(),a("li",{key:v._path},[c(N,{to:v._path},{default:w(()=>[c(G,H(J(v)),null,16)]),_:2},1032,["to"])]))),128))],2)])):V("",!0)]),_:1},8,["query"])]),_:1})])}}});export{re as default};
