import{_ as S}from"./BySlDHUv.js";import{_ as q}from"./Bf2dg_to.js";import{d as x,r as p,c as o,e as a,F as C,Z as A,G as f,f as g,t as E,n as D,Y as F,W as k,s as I,E as R,i as c,w,h as T,a1 as z,L,q as v,B as V}from"./s4yro8pX.js";import H from"./CWF-0wAW.js";import{u as j}from"./DUXchFhO.js";const J=["Ambient","Ambient Dub","Ambient Pop","Ambient Techno","Art Rock","Berlin School","Chamber Folk","Chamber Pop","Chillout","Choral","Dark Ambient","Dark Jazz","Downtempo","Dream Pop","Drone","Dub","Electronic","Experimental Rock","Glitch","IDM","Illbient","Indie Folk","Microhouse","Minimal Techno","Minimalism","Modern Classical","New Age","Novo Dub","Post-Industrial","Post-Minimalism","Post-Rock","Progressive Electronic","Singer-Songwriter","Space Ambient","Tape Music","Trip Hop","Video Game Music"],U={class:"flex flex-wrap gap-2"},W=["onClick"],Y=x({__name:"MusicGenres",emits:["select-genre"],setup(G,{emit:r}){const l=r,i=p(-1);function s(n){return console.log(n,i.value),n===i.value}function u(n,d,e){if(s(e))return i.value=-1,l("select-genre","*");i.value=e,l("select-genre",d)}return(n,d)=>(o(),a("div",U,[(o(!0),a(C,null,A(f(J),(e,m)=>(o(),a("div",{onClick:h=>u(h,e,m),class:"cursor-pointer",key:`genre-${e}`},[g("span",{class:D([{"bg-text dark:text-gray-90":s(m)},"genre bg-gray-90 text-gray-20 text-xs p-2 rounded-md line-clamp-1 bottom-0"])},E(e),3)],8,W))),128))]))}}),Z={class:"flex justify-between"},K={class:"mb-8 hidden md:block"},O={key:0},se=x({__name:"index",async setup(G){let r,l;const i=p({where:[{type:"album"}],limit:20,sort:[{date:-1}]}),s=p("Ambient"),{data:u}=([r,l]=F(()=>j("home",()=>v("albums").find()||[],{lazy:!0})),r=await r,l(),r);k(s,async t=>{await e(t)});const n=I();k(()=>n.fullPath,async()=>{console.log("route changed",n),await e(n.query.genre)},{immediate:!1});function d(t){if(t===s.value)return s.value="*";s.value=t}async function e(t){if(t==="*")return u.value=await v("albums").find()||[];if(u.value=await v("albums").where({genres:{$contains:t}}).find()||[],!window)return;const _=new URL(window==null?void 0:window.location.href);_.searchParams.set("genre",t),window==null||window.history.pushState({},"",_)}const m=p(4),h=R(()=>m.value?`grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-${m.value}`:"grid-cols-2 lg:grid-cols-3");return(t,_)=>{const M=S,P=q,$=V,B=H,N=z;return o(),a("main",null,[c(N,null,{default:w(()=>[g("div",Z,[c(M,{type:"h1",element:"h1",class:"mb-8",text:"Albums"})]),g("div",K,[c(Y,{onSelectGenre:_[0]||(_[0]=b=>d(b))})]),c(B,{query:f(i)},{default:w(({navigation:b})=>[b?(o(),a("div",O,[g("ul",{class:D(["grid gap-8",f(h)])},[(o(!0),a(C,null,A(f(u),y=>(o(),a("li",{key:y._path},[c($,{to:y._path},{default:w(()=>[c(P,L({ref_for:!0},y),null,16)]),_:2},1032,["to"])]))),128))],2)])):T("",!0)]),_:1},8,["query"])]),_:1})])}}});export{se as default};
