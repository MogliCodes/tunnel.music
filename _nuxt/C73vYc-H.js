import{_ as S}from"./Bk_K8LeY.js";import{_ as R}from"./BtZdZAQp.js";import{_ as q}from"./BNSL4FoR.js";import z from"./D7nOXRTu.js";import{_ as E}from"./B8qj3hqn.js";import{u as F}from"./DgYp217X.js";import{d as C,r as d,b as s,c as a,F as k,N as A,E as f,e as g,t as I,n as P,M as T,J as x,x as V,K as L,g as c,w as v,f as H,O as J,P as j,s as w}from"./Dh2Cs-si.js";import"./DrZtCY2a.js";const K=["Ambient","Ambient Dub","Ambient Pop","Ambient Techno","Art Rock","Berlin School","Chamber Folk","Chamber Pop","Chillout","Choral","Dark Ambient","Dark Jazz","Downtempo","Dream Pop","Drone","Dub","Electronic","Experimental Rock","Glitch","IDM","Illbient","Indie Folk","Microhouse","Minimal Techno","Minimalism","Modern Classical","New Age","Novo Dub","Post-Industrial","Post-Minimalism","Post-Rock","Progressive Electronic","Singer-Songwriter","Space Ambient","Tape Music","Trip Hop","Video Game Music"],O={class:"flex flex-wrap gap-2"},U=["onClick"],Q=C({__name:"MusicGenres",emits:["select-genre"],setup(D,{emit:r}){const l=r,i=d(-1);function o(n){return console.log(n,i.value),n===i.value}function u(n,p,e){if(o(e))return i.value=-1,l("select-genre","*");i.value=e,l("select-genre",p)}return(n,p)=>(s(),a("div",O,[(s(!0),a(k,null,A(f(K),(e,m)=>(s(),a("div",{onClick:h=>u(h,e,m),class:"cursor-pointer",key:`genre-${e}`},[g("span",{class:P([{"bg-text dark:text-gray-90":o(m)},"genre bg-gray-90 text-gray-20 text-xs p-2 rounded-md line-clamp-1 bottom-0"])},I(e),3)],8,U))),128))]))}}),W={class:"flex justify-between"},X={class:"mb-8"},Y={key:0},ie=C({__name:"index",async setup(D){let r,l;const i=d({where:[{type:"album"}],limit:20,sort:[{date:-1}]}),o=d("Ambient"),{data:u}=([r,l]=T(()=>F("home",()=>w("albums").find()||[],{lazy:!0})),r=await r,l(),r);x(o,async t=>{await e(t)});const n=V();x(()=>n.fullPath,async()=>{console.log("route changed",n),await e(n.query.genre)},{immediate:!1});function p(t){if(t===o.value)return o.value="*";o.value=t}async function e(t){if(t==="*")return u.value=await w("albums").find()||[];if(u.value=await w("albums").where({genres:{$contains:t}}).find()||[],!window)return;const _=new URL(window==null?void 0:window.location.href);_.searchParams.set("genre",t),window==null||window.history.pushState({},"",_)}const m=d(4),h=L(()=>m.value?`grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-${m.value}`:"grid-cols-2 lg:grid-cols-3");return(t,_)=>{const M=S,G=R,N=q,$=z,B=E;return s(),a("main",null,[c(B,null,{default:v(()=>[g("div",W,[c(M,{type:"h1",element:"h1",class:"mb-8",text:"Albums"})]),g("div",X,[c(Q,{onSelectGenre:_[0]||(_[0]=b=>p(b))})]),c($,{query:f(i)},{default:v(({navigation:b})=>[b?(s(),a("div",Y,[g("ul",{class:P(["grid gap-8",f(h)])},[(s(!0),a(k,null,A(f(u),y=>(s(),a("li",{key:y._path},[c(N,{to:y._path},{default:v(()=>[c(G,J(j(y)),null,16)]),_:2},1032,["to"])]))),128))],2)])):H("",!0)]),_:1},8,["query"])]),_:1})])}}});export{ie as default};
